<!DOCTYPE html>
<html lang="en">
<head>
    <title>dc.js - Number Display Example</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="../css/dc.css"/>
</head>
<body>

<div id="role-stability-row-chart"></div>
<div id="barriers-hist-chart"></div>

<script type="text/javascript" src="../js/d3.js"></script>
<script type="text/javascript" src="../js/crossfilter.js"></script>
<script type="text/javascript" src="../js/dc.js"></script>
<script type="text/javascript">

var barriersHistChart = dc.barChart("#barriers-hist-chart");
var roleStabilityRowChart = dc.rowChart("#role-stability-row-chart");

// use static or load via d3.csv("spendData.csv", function(error, spendData) {/* do stuff */});
var surveyData = [
  {
    "id":52463662,
    "q1":4,
    "q2":4,
    "q3":4,
    "q4":1,
    "q5":4,
    "q6":4,
    "q7":4,
    "q8":4,
    "q9":4,
    "q10":4,
    "q11":"Product / Design",
    "q11a":"",
    "q12":"Yes",
    "q13":"6-10",
    "q14":"6-10"
  },
  {
    "id":52480250,
    "q1":2,
    "q2":2,
    "q3":2,
    "q4":2,
    "q5":3,
    "q6":3,
    "q7":3,
    "q8":3,
    "q9":3,
    "q10":1,
    "q11":"Marketing / Sales",
    "q11a":"",
    "q12":"No",
    "q13":"6-10",
    "q14":"0"
  },
  {
    "id":52480732,
    "q1":1,
    "q2":3,
    "q3":2,
    "q4":2,
    "q5":3,
    "q6":2,
    "q7":3,
    "q8":3,
    "q9":3,
    "q10":2,
    "q11":"Product / Design",
    "q11a":"",
    "q12":"Yes",
    "q13":"11-20",
    "q14":"1-2"
  },
  {
    "id":52504616,
    "q1":3,
    "q2":2,
    "q3":3,
    "q4":1,
    "q5":3,
    "q6":2,
    "q7":3,
    "q8":1,
    "q9":4,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"21-50",
    "q14":"0"
  },
  {
    "id":52524712,
    "q1":3,
    "q2":3,
    "q3":4,
    "q4":1,
    "q5":4,
    "q6":3,
    "q7":3,
    "q8":4,
    "q9":4,
    "q10":3,
    "q11":"Product / Design",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52528830,
    "q1":3,
    "q2":3,
    "q3":4,
    "q4":1,
    "q5":3,
    "q6":3,
    "q7":3,
    "q8":3,
    "q9":4,
    "q10":3,
    "q11":"Marketing / Sales",
    "q11a":"",
    "q12":"Yes",
    "q13":"51-200",
    "q14":"3-5"
  },
  {
    "id":52557760,
    "q1":2,
    "q2":3,
    "q3":3,
    "q4":2,
    "q5":3,
    "q6":3,
    "q7":4,
    "q8":3,
    "q9":4,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52557918,
    "q1":3,
    "q2":3,
    "q3":3,
    "q4":1,
    "q5":3,
    "q6":3,
    "q7":3,
    "q8":2,
    "q9":4,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52558086,
    "q1":2,
    "q2":2,
    "q3":3,
    "q4":1,
    "q5":2,
    "q6":1,
    "q7":2,
    "q8":1,
    "q9":4,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"21-50",
    "q14":"0"
  },
  {
    "id":52559216,
    "q1":3,
    "q2":3,
    "q3":3,
    "q4":3,
    "q5":3,
    "q6":3,
    "q7":4,
    "q8":3,
    "q9":3,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52571062,
    "q1":3,
    "q2":1,
    "q3":1,
    "q4":3,
    "q5":2,
    "q6":1,
    "q7":2,
    "q8":2,
    "q9":3,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"Yes",
    "q13":"51-200",
    "q14":"11-20"
  },
  {
    "id":52571364,
    "q1":3,
    "q2":2,
    "q3":3,
    "q4":2,
    "q5":3,
    "q6":3,
    "q7":3,
    "q8":4,
    "q9":4,
    "q10":3,
    "q11":"Other, please specify...",
    "q11a":"Operations",
    "q12":"Yes",
    "q13":"51-200",
    "q14":"1-2"
  },
  {
    "id":52575236,
    "q1":2,
    "q2":2,
    "q3":4,
    "q4":3,
    "q5":2,
    "q6":1,
    "q7":1,
    "q8":3,
    "q9":3,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52577866,
    "q1":2,
    "q2":2,
    "q3":3,
    "q4":2,
    "q5":3,
    "q6":3,
    "q7":3,
    "q8":1,
    "q9":3,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"11-20",
    "q14":"0"
  },
  {
    "id":52586438,
    "q1":3,
    "q2":4,
    "q3":4,
    "q4":2,
    "q5":4,
    "q6":4,
    "q7":4,
    "q8":4,
    "q9":4,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"11-20",
    "q14":"0"
  },
  {
    "id":52648132,
    "q1":3,
    "q2":2,
    "q3":2,
    "q4":3,
    "q5":2,
    "q6":3,
    "q7":3,
    "q8":2,
    "q9":1,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"11-20",
    "q14":"0"
  },
  {
    "id":52648536,
    "q1":1,
    "q2":1,
    "q3":3,
    "q4":2,
    "q5":3,
    "q6":3,
    "q7":1,
    "q8":3,
    "q9":2,
    "q10":2,
    "q11":"Product / Design",
    "q11a":"",
    "q12":"Yes",
    "q13":"11-20",
    "q14":"0"
  },
  {
    "id":52651714,
    "q1":3,
    "q2":2,
    "q3":2,
    "q4":1,
    "q5":3,
    "q6":2,
    "q7":3,
    "q8":2,
    "q9":3,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52655826,
    "q1":3,
    "q2":1,
    "q3":2,
    "q4":3,
    "q5":2,
    "q6":4,
    "q7":1,
    "q8":2,
    "q9":1,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"11-20",
    "q14":"1-2"
  },
  {
    "id":52667520,
    "q1":3,
    "q2":1,
    "q3":2,
    "q4":2,
    "q5":3,
    "q6":2,
    "q7":3,
    "q8":2,
    "q9":2,
    "q10":3,
    "q11":"Marketing / Sales",
    "q11a":"",
    "q12":"Yes",
    "q13":"6-10",
    "q14":"1-2"
  },
  {
    "id":52670130,
    "q1":3,
    "q2":3,
    "q3":2,
    "q4":3,
    "q5":3,
    "q6":3,
    "q7":3,
    "q8":2,
    "q9":1,
    "q10":3,
    "q11":"Marketing / Sales",
    "q11a":"",
    "q12":"No",
    "q13":"11-20",
    "q14":"0"
  },
  {
    "id":52670946,
    "q1":3,
    "q2":3,
    "q3":4,
    "q4":1,
    "q5":4,
    "q6":3,
    "q7":4,
    "q8":1,
    "q9":4,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52674430,
    "q1":3,
    "q2":3,
    "q3":4,
    "q4":2,
    "q5":3,
    "q6":3,
    "q7":4,
    "q8":2,
    "q9":4,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"Yes",
    "q13":"21-50",
    "q14":"3-5"
  },
  {
    "id":52678116,
    "q1":2,
    "q2":2,
    "q3":1,
    "q4":4,
    "q5":2,
    "q6":1,
    "q7":2,
    "q8":2,
    "q9":2,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"21-50",
    "q14":"0"
  },
  {
    "id":52682532,
    "q1":2,
    "q2":2,
    "q3":3,
    "q4":4,
    "q5":2,
    "q6":1,
    "q7":1,
    "q8":3,
    "q9":1,
    "q10":2,
    "q11":"Delivery / Client Services",
    "q11a":"",
    "q12":"Yes",
    "q13":"11-20",
    "q14":"6-10"
  },
  {
    "id":52692176,
    "q1":3,
    "q2":3,
    "q3":3,
    "q4":2,
    "q5":4,
    "q6":3,
    "q7":4,
    "q8":3,
    "q9":4,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"3-5"
  },
  {
    "id":52695828,
    "q1":3,
    "q2":2,
    "q3":4,
    "q4":3,
    "q5":3,
    "q6":3,
    "q7":3,
    "q8":2,
    "q9":4,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"Yes",
    "q13":"11-20",
    "q14":"11-20"
  },
  {
    "id":52697540,
    "q1":3,
    "q2":3,
    "q3":3,
    "q4":2,
    "q5":3,
    "q6":3,
    "q7":4,
    "q8":1,
    "q9":3,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52698434,
    "q1":3,
    "q2":4,
    "q3":3,
    "q4":1,
    "q5":4,
    "q6":4,
    "q7":3,
    "q8":2,
    "q9":4,
    "q10":4,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"21-50",
    "q14":"0"
  },
  {
    "id":52698614,
    "q1":4,
    "q2":4,
    "q3":4,
    "q4":2,
    "q5":4,
    "q6":4,
    "q7":4,
    "q8":3,
    "q9":4,
    "q10":3,
    "q11":"Marketing / Sales",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52698732,
    "q1":4,
    "q2":2,
    "q3":3,
    "q4":1,
    "q5":2,
    "q6":3,
    "q7":3,
    "q8":2,
    "q9":4,
    "q10":4,
    "q11":"Marketing / Sales",
    "q11a":"",
    "q12":"Yes",
    "q13":"6-10",
    "q14":"1-2"
  },
  {
    "id":52701180,
    "q1":3,
    "q2":4,
    "q3":4,
    "q4":2,
    "q5":3,
    "q6":3,
    "q7":3,
    "q8":4,
    "q9":4,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52704232,
    "q1":4,
    "q2":4,
    "q3":3,
    "q4":1,
    "q5":4,
    "q6":3,
    "q7":4,
    "q8":2,
    "q9":4,
    "q10":3,
    "q11":"Marketing / Sales",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52704848,
    "q1":2,
    "q2":2,
    "q3":3,
    "q4":2,
    "q5":3,
    "q6":4,
    "q7":3,
    "q8":3,
    "q9":2,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"0-5",
    "q14":"0"
  },
  {
    "id":52705576,
    "q1":3,
    "q2":2,
    "q3":3,
    "q4":2,
    "q5":4,
    "q6":3,
    "q7":3,
    "q8":4,
    "q9":3,
    "q10":3,
    "q11":"Marketing / Sales",
    "q11a":"",
    "q12":"No",
    "q13":"6-10",
    "q14":"0"
  },
  {
    "id":52710060,
    "q1":3,
    "q2":2,
    "q3":3,
    "q4":1,
    "q5":3,
    "q6":3,
    "q7":3,
    "q8":4,
    "q9":4,
    "q10":4,
    "q11":"Product / Design",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"1-2"
  },
  {
    "id":52711354,
    "q1":3,
    "q2":1,
    "q3":2,
    "q4":3,
    "q5":3,
    "q6":2,
    "q7":2,
    "q8":1,
    "q9":3,
    "q10":3,
    "q11":"Delivery / Client Services",
    "q11a":"Management / Delivery / Client Services",
    "q12":"Yes",
    "q13":"21-50",
    "q14":"11-20"
  },
  {
    "id":52713812,
    "q1":4,
    "q2":2,
    "q3":3,
    "q4":3,
    "q5":2,
    "q6":2,
    "q7":2,
    "q8":3,
    "q9":2,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52715522,
    "q1":3,
    "q2":2,
    "q3":4,
    "q4":3,
    "q5":4,
    "q6":4,
    "q7":4,
    "q8":4,
    "q9":3,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"Yes",
    "q13":"0-5",
    "q14":"0"
  },
  {
    "id":52842040,
    "q1":3,
    "q2":3,
    "q3":1,
    "q4":2,
    "q5":2,
    "q6":2,
    "q7":3,
    "q8":2,
    "q9":2,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52853864,
    "q1":3,
    "q2":2,
    "q3":2,
    "q4":2,
    "q5":4,
    "q6":2,
    "q7":2,
    "q8":2,
    "q9":3,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"21-50",
    "q14":"0"
  },
  {
    "id":52884864,
    "q1":4,
    "q2":1,
    "q3":4,
    "q4":1,
    "q5":4,
    "q6":4,
    "q7":4,
    "q8":4,
    "q9":4,
    "q10":4,
    "q11":"Product / Design",
    "q11a":"",
    "q12":"No",
    "q13":"6-10",
    "q14":"0"
  },
  {
    "id":52902324,
    "q1":2,
    "q2":3,
    "q3":3,
    "q4":2,
    "q5":4,
    "q6":3,
    "q7":4,
    "q8":3,
    "q9":2,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"Yes",
    "q13":"21-50",
    "q14":"1-2"
  },
  {
    "id":52907522,
    "q1":4,
    "q2":4,
    "q3":3,
    "q4":4,
    "q5":4,
    "q6":4,
    "q7":4,
    "q8":4,
    "q9":4,
    "q10":4,
    "q11":"Other, please specify...",
    "q11a":"Everything not related to engineering.",
    "q12":"Yes",
    "q13":"0-5",
    "q14":"0"
  },
  {
    "id":52917566,
    "q1":3,
    "q2":1,
    "q3":4,
    "q4":2,
    "q5":3,
    "q6":2,
    "q7":2,
    "q8":2,
    "q9":3,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"11-20",
    "q14":"0"
  },
  {
    "id":52917584,
    "q1":3,
    "q2":3,
    "q3":3,
    "q4":2,
    "q5":3,
    "q6":4,
    "q7":4,
    "q8":2,
    "q9":3,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"21-50",
    "q14":"0"
  },
  {
    "id":52921258,
    "q1":1,
    "q2":2,
    "q3":2,
    "q4":4,
    "q5":2,
    "q6":4,
    "q7":2,
    "q8":3,
    "q9":1,
    "q10":2,
    "q11":"Delivery / Client Services",
    "q11a":"Customer Success",
    "q12":"Yes",
    "q13":"6-10",
    "q14":"1-2"
  },
  {
    "id":52940308,
    "q1":4,
    "q2":4,
    "q3":4,
    "q4":1,
    "q5":4,
    "q6":4,
    "q7":3,
    "q8":2,
    "q9":4,
    "q10":4,
    "q11":"Other, please specify...",
    "q11a":"CEO",
    "q12":"Yes",
    "q13":"6-10",
    "q14":"3-5"
  },
  {
    "id":52947020,
    "q1":3,
    "q2":3,
    "q3":4,
    "q4":2,
    "q5":4,
    "q6":3,
    "q7":4,
    "q8":2,
    "q9":3,
    "q10":4,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":52954528,
    "q1":3,
    "q2":2,
    "q3":3,
    "q4":2,
    "q5":4,
    "q6":3,
    "q7":4,
    "q8":3,
    "q9":2,
    "q10":3,
    "q11":"Product / Design",
    "q11a":"",
    "q12":"No",
    "q13":"51-200",
    "q14":"0"
  },
  {
    "id":53015208,
    "q1":3,
    "q2":4,
    "q3":4,
    "q4":1,
    "q5":4,
    "q6":3,
    "q7":4,
    "q8":3,
    "q9":4,
    "q10":3,
    "q11":"Delivery / Client Services",
    "q11a":"",
    "q12":"No",
    "q13":"6-10",
    "q14":"1-2"
  },
  {
    "id":53048472,
    "q1":2,
    "q2":3,
    "q3":3,
    "q4":1,
    "q5":3,
    "q6":2,
    "q7":3,
    "q8":4,
    "q9":3,
    "q10":3,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"No",
    "q13":"21-50",
    "q14":"0"
  },
  {
    "id":53123446,
    "q1":3,
    "q2":3,
    "q3":3,
    "q4":2,
    "q5":4,
    "q6":4,
    "q7":4,
    "q8":2,
    "q9":4,
    "q10":3,
    "q11":"Other, please specify...",
    "q11a":"Founder",
    "q12":"Yes",
    "q13":"6-10",
    "q14":"6-10"
  },
  {
    "id":53135470,
    "q1":3,
    "q2":1,
    "q3":3,
    "q4":2,
    "q5":4,
    "q6":4,
    "q7":2,
    "q8":1,
    "q9":3,
    "q10":2,
    "q11":"Technology / Engineering",
    "q11a":"",
    "q12":"Yes",
    "q13":"6-10",
    "q14":"1-2"
  },
  {
    "id":53152750,
    "q1":4,
    "q2":3,
    "q3":3,
    "q4":2,
    "q5":4,
    "q6":4,
    "q7":3,
    "q8":3,
    "q9":4,
    "q10":3,
    "q11":"Product / Design",
    "q11a":"",
    "q12":"Yes",
    "q13":"0-5",
    "q14":"1-2"
  },
  {
    "id":53226988,
    "q1":4,
    "q2":3,
    "q3":3,
    "q4":2,
    "q5":3,
    "q6":4,
    "q7":3,
    "q8":3,
    "q9":4,
    "q10":3,
    "q11":"Other, please specify...",
    "q11a":"Founder / CEO",
    "q12":"Yes",
    "q13":"0-5",
    "q14":"1-2"
  }
];

// set crossfilter
var survey = crossfilter(surveyData),
    roleDim  = survey.dimension(function(d) {return d.q11;}),
    stabilityPerRole = roleDim.group().reduceSum(function(d) {
        avg = 0;
        if (d.q11 == "Product / Design") {
            avg = d.q8/8;
        } else if (d.q11 == "Technology / Engineering") {
            avg = d.q8/31;
        } else if (d.q11 == "Marketing / Sales") {
            avg = d.q8/8;
        } else if (d.q11 == "Delivery / Client Services") {
            avg = d.q8/4;
        } else {
            avg = d.q8/5;
        }
        return avg;
    }),

    barrierDim  = survey.dimension(function(d) {return d.q8;}),
    barrierHist = barrierDim.group().reduceCount();    

barriersHistChart
    .width(300).height(200)
    .dimension(barrierDim)
    .group(barrierHist)
    .x(d3.scale.linear().domain([1,5]))
    .elasticY(true);

roleStabilityRowChart
    .width(350).height(200)
    .dimension(roleDim)
    .group(stabilityPerRole)
    .ordering(function(d){ return -d.value })
    .elasticX(true);

dc.renderAll();

</script>

</body>
</html>
